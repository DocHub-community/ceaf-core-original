# CEAF
Community Enterprise Architecture Framework (CEAF) - открытый и развиваемый сообществом экспертов-практиков архитектурный фреймворк в своей основе использующий подход "Архитектура как код". 
Создан на основе форка от [SEAF](https://github.com/SEAFTeam/seaf-core). 

**ВНИМАНИЕ**: Кодовая база в процессе рефакторинга. Следите за релизами.

## Быстрый старт

1. Установите DocHub используя [инструкцию](https://github.com/RabotaRu/dochub?tab=readme-ov-file#%D0%B1%D1%8B%D1%81%D1%82%D1%80%D1%8B%D0%B9-%D1%81%D1%82%D0%B0%D1%80%D1%82).
Для ознакомления, рекомендуется использовать вариант развертывания - плагин для IDEA;
2. Клонируйте данный репозиторий;
3. Откройте проект в IDE.

## Архитектура фреймворка
```mermaid
flowchart TB
    subgraph "Community Enterprise Architect Framework (СEAF)"
        subgraph 1. Философия
        id2(2. Подходы и принципы)
        id3(3. Ценности)
        id4(4. Протомодель)
        end
        subgraph 5. Поставка
            id6(6. Референсный инструмент)
            id7(7. Методология)
            id8(8. Практики/кейсы)
            id9(9. Базовая метамодель)
            id10(10. Документация)
        end
        subgraph 11.Сообщество
            id12(12. Репозиторий фреймворка)
            id13(13. Проф. группы и каналы)
            id14(14. Статьи, воркшопы, митапы)
        end
    end
```
* (1, 2, 3, 4) Философия фреймворка выражается в [манифесте](#манифест);
* (5) Под поставкой понимается выпуск очередного релиза фреймворка в форме repo;
* (6) В качестве инструмента используется [DocHub](https://github.com/RabotaRu/DocHub);
* (7) Методология включается в виде документов в поставку;
* (8) Поставка содержит репозиторий [примеров](https://github.com/rpiontik/DocHubExamples)
  применения подхода;
* (9) Входит в поставку;
* (10) Входит в поставку;
* (11) Сообщество обеспечивает развитие фреймворка и генерирует поставку;
* (12) [Репозиторий фреймворка](https://github.com/rpiontik/ceaf-core-original);
* (13) Группа сообщества развивающего подход управления архитектуры кодом [DocHubTeam](https://t.me/archascode);
* (14) [Статьи о развитии подхода](https://habr.com/ru/users/rpiontik/) и видео
  c [воркшопами и митапами](https://www.youtube.com/@user-eq5pj3zk6w).

## Метамодель

СEAF предусматривает мутабельность метамодели. Ее постоянное совершенствование сообществом.

### Базовый подход к формированию слоев и вертикалей

Для структурирования метамодели выбран подход разделения ее на слои и вертикали.

Слои выделяют функциональные области, в то время как вертикали пронизывают их и связывают.

Выделяются слои:
1. Бизнес-архитектура;
2. Прикладная архитектура;
3. Техническая архитектура.

Вертикали:
1. Информационная архитектура;
2. Управление требованиями.

Важным принципом метамодели является - адаптивность. Она должна легко подстраиваться под нужды использования. Предусматривать частичное применение, возможность расширения и модификации.

Таким образом, решение о фактическом объеме использования метамодели предоставляется пользователю. 

### Общая метамодель

![Метамодель](docs/img/mm.png)

## Архитектурный репозиторий

В основе CEAF лежит подход "Архитектура как код". Любое архитектурное описание выражается архитектурным кодом - **архкодом**. Для управления им актуальны практики управления кодом приложений, инфраструктуры и т.п.

Но есть и отличия ввиду специфики предметной области - управление архитектурой.

Для удобства сообщества фреймворк предлагает стандартизацию некоторых аспектов управления архкодом. 


### Соглашение по структуре архитектурных пакетов
```
|- _metamodel_                 - Подключенные пакеты метамоделей
|  |- [название пакета]        - Пакет метамодели
|  |  |- datasets              - Датасеты для архитектурных пакетов
|  |  |- entities              - Сущности метамодели
|  |  |  |- [...]              - Структура каталогов сущностей
|  |  |  |  |- template        - Шаблоны для презентаций
|  |  |- functions             - Функции конкретного архитектурного пакета
|  |  |- rules                 - Правила валидации конкретного архитектурного пакета
|  |  |- dochub.yaml           - Корневой манифест конкретного архитектурного пакета
|  |  |- LICENSE               - Лицензия использования конкретного архитектурного пакета
|  |  |- README.md             - Ключевая информация по конкретному архитектурному пакету
|- architecture_ceaf_example   - Пакет с примером описанием архитектурных артефактов вымышленной организации "ГК Болото"
|  |- app                      - Архитектурные артефакты для прикладного слоя управления архитектурой
|  |- ba                       - Архитектурные артефакты для бизнес-слоя управления архитектурой
|  |- ia                       - Архитектурные артефакты для  информационного слоя управления архитектурой
|  |- ta                       - Архитектурные артефакты для технического слоя управления архитектурой
|  |- change                   - Архитектурные артефакты для управления изменениями
|  |- integration              - Архитектурные артефакты для управления интеграциями
|  |- dochub.yaml              - Корневой манифест пакета
|  |- LICENSE                  - Лицензия использования пакета
|  |- README.md                - Ключевая информация по пакету
|- ceaf_doc                    - Пакет с детальной документацией по фреймворку CEAF
|  |- metamodel                - Каталог содержащий в себе детальные описания пакетов метамодели
|  |  |- [название пакета]     - Детальное описание пакетов метамодели
|  |- dochub.yaml              - Корневой манифест пакета
|  |- LICENSE                  - Лицензия использования пакета
|  |- README.md                - Ключевая информация по пакету
|- dochub.yaml                 - Корневой манифест репозитория ceaf-core-original
|- LICENSE                     - Лицензия под которой распространяется пакет
|- README.md                   - Ключевая информация по репозиторию ceaf-core-original

```

Предлагаемая структура является рекомендуемой и может расширяться при необходимости.

## Соглашение по структуре меню
```
|- Архитектура                      - Хранилище архитектурных артефактов
|  |- Прикладная                    - Архитектурные артефакты для прикладного слоя управления архитектурой
|  |- Бизнес                        - Архитектурные артефакты для бизнес-слоя управления архитектурой
|  |- Информационная                - Архитектурные артефакты для  информационного слоя управления архитектурой
|  |- Техническая                   - Архитектурные артефакты для технического слоя управления архитектурой
|  |- Управление изменениями        - Архитектурные артефакты для управления изменениями
|  |  |- ADR                        - Архитектурные решения
|  |  |- Требования                 - Требования (бизнес/функциональные/нефункциональные)
|  |- Управление интеграциями       - Архитектурные артефакты для управления интеграциями
|- Документация                     - Статистика по метамодели
|  |- CEAF                          - Документация по CEAF
|  |  |- Бизнес-архитектура         - Документация по управлению бизнес-архитектурой
|  |  |- Информационная архитектура - Документация по управлению информационной архитектурой
|  |  |- Прикладная архитектура     - Документация по управлению прикладной архитектурой
|  |  |- Техническая архитектура    - Документация по управлению технической архитектурой
|  |  |- Управление изменениями     - Документация по управлению изменениями
|  |  |- Управление интеграциями    - Документация по управлению интеграциями
|  |  |- Исследователь метамодели   - Документация по исследователю метамодели
|  |- DocHub                        - Документация по DocHub
|  |- [название организации]        - Документация конкретной организации

```

### Соглашение по идентификации архитектурных объектов

1. Идентификаторы должны соответствовать принципу DDD (структурированные идентифкаторы);
2. Используются только строчные символы;
3. Для разделения домена используется символ - "."
4. Для разделения слов - "_";
5. Системные идентификаторы должны начинаться с "$";
6. В идентификаторах могу быть использованы только символы - a..z 0..9 "_" "." "$";
7. Идентификаторы должны отражать смысл и быть существительным.

**RegEx для идентификаторов:** ^\[a-z0-9_\$]\[a-z0-9_\$]\*(\.\[a-z0-9_\$]\[a-z0-9_\$]\*)*$

Предлагается следующая структура идентификаторов:
```
[зона www].[домен].**
```

Примеры:
```
info.dochub.frontend
ru.nalog.site_fns
ru.yandex.app.search
```

## Процессы управления

Использование систем управления версиями положено в основу предлагаемых процессов. 

### Сегментация кодовой базы

Рекомендуется сегментировать кодовую базу в соответствии с логическими пространствами
доменов управления, придерживаясь принципов федеративного управления архитектурой.

Например, если вы практикуете микросервисную архитектуру, будет уместно выделить следующие сегменты
и разместить их в отдельных репозиториях:

1. **Metamodel** - стандартизированная метамодель, которую будут использовать и развивать все команды;
2. **General** - репозиторий обобщающий информацию о всех микросервисах и представляющий их как систему
   для нужд всех команд;
3. **TeamN** - репозиторий команды, в котором она развивает архитектуру микросервисов.

Такое разделение позволит минимизировать информационный шум для участников архитектурных преобразований,
а также настроить ролевую модель.

Для удобства разработчиков, архкод развиваемый командой, допускается расположить непосредственно в 
репозиториях микросервисов.

```mermaid
sequenceDiagram
    actor Team 1
    actor Team 2
    participant DocHub
    participant Repo Metamodel
    participant Repo Main
    participant Repo 1
    participant Repo 2

    alt Обзор архитектуры
        Repo Metamodel->>DocHub: Метамодель
        Repo Main->>DocHub: Концептуальная архитектура
        Repo 1->>DocHub: Детальная архитектура
        Repo 2->>DocHub: Детальная архитектура
        DocHub->>Team 1: Артефакты
        DocHub->>Team 2: Артефакты
    end

    alt Фокус на свой домен
        Repo Metamodel->>DocHub: Метамодель
        Repo 1->>DocHub: Детальная архитектура
        DocHub->>Team 1: Артефакты
    end
```

Связать репозитории и представить их в едином интерфейсе позволит референсный инструмент -
[DocHub](https://dochub.info/)

### Развитие архкода

В качестве целей развития архкода рассматривается :
1. Проектирование и планирование архитектурных изменений (to-be);
2. Фиксация и документирование состоявшихся изменений (as-is).

Для реализации этих целей предлагается следующий процесс: 

```mermaid
gitGraph
    commit id: "First commit"
    branch "ADR#"
    commit
    branch increment
    commit tag: "req-1"
    commit tag: "req-2"
    checkout "ADR#"
    merge increment

    checkout "main"
    commit
    checkout "ADR#"
    merge "main"

    checkout "ADR#"
    commit tag: "TO-DO"
    branch "change#"
    checkout "change#"
    commit tag: "done"

    checkout "main"
    commit
    checkout "change#"
    merge main


    checkout main
    merge "change#"
    commit tag: "ADR#"
```

Здесь ветка **"main"** отражает "как есть", т.е. представление о том, какая архитектура
имеется на текущий момент.

При необходимости архитектурных преобразований, создается ветка **ADR (Architecture Decision Record)**.
Первоначально в ветке отражается суть преобразований. Т.е. регистрируется сам ADR.

ADR подразумевает одно преобразование или их комплекс. Каждое целевое преобразование
оформляется как архитектурный инкремент - **Increment**.

Increment отщипывается от ветки ADR и развивается в соответствии с требованиями по
преобразованию. При завершении имплементации требования, комит тегируется 
исполненным требованием. Это делается для удобства контроля полноты реализации
ADR, а также позволяет локализовывать сегмент архкода отвечающий за них.

По завершению наполнения инкремента, он вливается в ветку ADR.

Когда ветка ADR скомплектована, она тегируется к реализации **"to-do"**.

Готовые к реализации ADR берутся в работу. Для этого от ADR отщипывается ветка
**"change"**. В ходе реализации ветки, допускается детализация архкода без 
противоречия сути ADR.

После имплементации преобразований, ветка change вливается в main. 
Таким образом происходит актуализация архитектуры "как есть". Актуализация
тегируется исполненным ADR с целью контроля его реализации.

Если ADR оказывается слишком сложным (большим), необходимо его декомпозировать.
Для этого использовать подход структурирования идентификаторов. Например, ADR по 
созданию новой системы с номером ARD12 разделить на: ADR12.1; ADR12.2 и т.д.

Такая идентификация позволит не утерять смысл при чтении тегов и проще 
контролировать целостность преобразований.

__При развитии архкода, на постоянной основе, должна происходить синхронизация с веткой
main для актуализации знаний о реальной архитектуре с целью контроля реализуемости 
проектируемых изменений.__

### Федеративное управление архитектурой

CEAF рассматривает федеративное управление архитектурой как инструмент эффективного
управления архитектурой в сложных, неоднородных системах и системах с динамической
сложностью.

Федерация это совокупность доменов с автономным управлением связанная в систему
контрактами.

#### Домены управления

Для разделения на домены управления необходимо определить критерии. Для каждого 
случая они могут быть уникальными. Типовые:
* Организационная единица (департамент, управление, команда и т.д);
* Продуктовая единица (цифровой продукт, вертикаль и т.д.);
* Сервисная единица (сервис авторизации, сервис оплаты и т.д.).

При выделении домена необходимо стремиться к однородности процесса
управления архитектурой в нем. Признаками могут стать единые стандарты для
домена, технологический стек, единый релизный цикл и т.д.

Домену выделяется пространство имен, в котором он описывает архитектурные объекты 
и специфичную метамодель. 

Например:
- ru.company.it.auth.*
- ru.company.product1.*  

#### Контракты

При выделении домена с ним заключается контракт. Контракт подразумевает доступ
домена к информации об архитектуре федерации в обмен на обязательства предоставлять 
информацию о себе.

Структура и состав информации поступающей из федерации и из домена декларируется
специальный метамоделью. Таким образом поддерживается необходимое качество и актуальность 
информации на уровне федерации.

Контракт актуализируется по мерен необходимости.

#### Передача управления в домен

После определения рамок домена управления и контрактов с ним, управление архитектурой
передается в домен. Он волен развивать свою частную метамодель под свои нужды.

Контролируется функционирование домена исключительно по выполнению контракта.

#### Право домена на автономное развитие

Внутри себя домен волен создавать собственную федерацию на иных принципах деления
на домены, с локальными контрактами и т.д.

#### Процесс

```mermaid
sequenceDiagram
    participant Owner
    participant Domain1
    participant Domain2
    participant Domain2.subdomain1
    participant Domain2.subdomain2

    Owner->>Domain1: Информация о федерации
    Domain1->>Owner: Информация о домене

    Owner->>Domain2: Информация о федерации

    Domain2->>Domain2.subdomain1: Информация о федерации
    Domain2->>Domain2.subdomain2: Информация о федерации

    Domain2.subdomain1->>Domain2: Информация о домене
    Domain2.subdomain2->>Domain2: Информация о домене

    Domain2->>Owner: Информация о домене
```

## Развитие фремворка CEAF

### Манифест

1. Миссия сообщества CEAF - создание технологии цифрового моделирования предприятия. Мы считаем, что достичь ее можно описывая архитектуру специальным кодом, поддающимся автоматизированному анализу

1. Вклад сообщества в развитие фреймворка является наивысшей ценностью для нас

1. Мы не противопоставляем CEAF другим фреймворкам. Наш принцип – использовать лучшее из них

1. Мы считаем, что CEAF должен удовлетворять потребностям предприятий любого масштаба. Обеспечивать их ценностью на всех этапах развития

1. Трансформация является главным драйвером принятия архитектурных решений. Трансформация выполняется разными ролями в организации. CEAF должен дать возможность всем участникам трансформации принимать рациональные решения

1. Мы поставляем метамодель и методологию, которые могут адаптироваться и развиваться под потребности конкретного предприятия

1. Мы рады приветствовать в сообществе CEAF людей, открытых к новым идеям, стремящихся к лидерству в изменениях, готовых к экспертному развитию и профессиональному росту

1. Мы верим, что CEAF технологический фреймворк нового эволюционного этапа развития организации:
    * Позволяет встраивать управление архитектурой в производственный процесс
    * Описывать цифровую модель предприятия
    * Создаёт новый рынок экспертизы, который будет востребован в ближайшем будущем

### Развитие кодовой базы фреймворка

Управляет релизным циклом команда развития СEAF. Мы используем следующий процесс:     

```mermaid
gitGraph
    commit id: "Initial"
    branch master
    commit id: "First commit"
    branch v1.0.0
    commit
    branch feature
    commit
    commit
    checkout v1.0.0
    merge feature
    checkout master
    merge v1.0.0
    commit id: "Release" tag: "v1.0.0"
    branch hotfix1
    checkout hotfix1
    commit id: "Fix"
    checkout master
    merge hotfix1
    commit id: "Hotfix" tag: "v1.0.1"
```

### Как сделать вклад 

Сделайте форк данного репозитория под своей учетной записью в GitHub. 
Внесите изменения и оформите Pull Request в ветку master.

Pull Request будет рассмотрен командой развития. В случае успешного ревью он 
автоматически войдет в следующий релиз.

При наличии замечаний, они будут оформлены как комментарии в Pull Request. 

При необходимости команда развития свяжется с вами для уточнений.

## Лицензия

Распространяется под лицензией Apache License 2.0 Open source license.


!!! Термины

Наш клиент - организация или лицо ее представляющее, которые действительно используют продукт или действительно собираются его использовать.

Наше комьюнити - сообщество полностью или частично разделяющее идею продукта.

!!! Отказ от обязательств в строгом планировании

Наши опубликованные планы, это планы в который мы искренне верим сегодня. Но они является лишь инструментом координации команды и комьюнити продукта. Они могут пересматриваться в любой момент, когда станет очевидным, что они устарели.